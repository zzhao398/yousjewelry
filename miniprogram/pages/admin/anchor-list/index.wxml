<view class="page">
  <!-- 顶部标题 + 一键重建按钮 -->
  <view class="page-header">
    <text class="page-title">主播信息管理</text>
    <button class="btn-rebuild-all" bindtap="onRebuildAll">
      一键重建订单索引
    </button>
  </view>

  <view wx:if="{{loading}}" class="tips">加载中...</view>
  <view wx:elif="{{!list.length}}" class="tips">暂无已通过的主播</view>

  <block wx:for="{{list}}" wx:key="_id">
    <view class="card">
      <view class="row">
        <text class="label">主播ID：</text>
        <text class="value strong">{{item.anchorId || '-'}}</text>
      </view>
      <view class="row">
        <text class="label">姓名：</text>
        <text class="value">{{item.realName || item.displayName}}</text>
      </view>
      <view class="row">
        <text class="label">登录账号：</text>
        <text class="value">{{item.loginAccount}}</text>
      </view>
      <view class="row">
        <text class="label">手机号：</text>
        <text class="value">{{item.phone || '-'}}</text>
      </view>
      <view class="row">
        <text class="label">平台：</text>
        <text class="value">{{item.platform || '-'}}</text>
      </view>
      <view class="row">
        <text class="label">平台账号：</text>
        <text class="value">{{item.accountId || '-'}}</text>
      </view>

      <!-- 绑定 PID 可编辑输入框 -->
      <view class="row multi">
        <text class="label">绑定商品ID：</text>
        <input
          class="input"
          placeholder="多个 productId 用逗号或空格分隔"
          value="{{item.productIdsStr}}"
          data-index="{{index}}"
          bindinput="onProductIdsInput"
        />
      </view>
      <view class="hint">
        说明：一个主播可以绑定多个商品ID，支持英文逗号、中文逗号或空格分隔。
      </view>

      <!-- 按钮行：右对齐 -->
      <view class="btn-row">
        <button
          class="btn-save"
          data-index="{{index}}"
          bindtap="onSave"
        >
          保存绑定
        </button>
        <button
          class="btn-backfill"
          data-anchor-id="{{item.anchorId}}"
          bindtap="onBackfill"
        >
          回填历史订单
        </button>
      </view>
    </view>
  </block>
</view>
